<div class="detail-container">
  <div class="detail-card" *ngIf="!isEditing">

    <!-- Header -->
    <div class="detail-header">
      <button class="back-btn" routerLink="/songs">â† Volver</button>
      <span class="explicit-badge" *ngIf="song().isExplicit">ğŸ…´ Contenido ExplÃ­cito</span>
    </div>

    <!-- Album Art Placeholder -->
    <div class="album-art">
      <div class="music-icon">ğŸµ</div>
    </div>

    <!-- Song Title & Artist -->
    <div class="title-section">
      <h1 class="song-title">{{ song().title || 'Cargando...' }}</h1>
      <h2 class="song-artist">{{ song().artist }}</h2>
    </div>

    <!-- Song Details Grid -->
    <div class="details-grid">

      <div class="detail-item">
        <div class="detail-icon">ğŸ’¿</div>
        <div class="detail-content">
          <span class="detail-label">Ãlbum</span>
          <span class="detail-value">{{ song().album }}</span>
        </div>
      </div>

      <div class="detail-item">
        <div class="detail-icon">ğŸ¸</div>
        <div class="detail-content">
          <span class="detail-label">GÃ©nero</span>
          <span class="detail-value">{{ song().genre }}</span>
        </div>
      </div>

      <div class="detail-item">
        <div class="detail-icon">ğŸ“…</div>
        <div class="detail-content">
          <span class="detail-label">AÃ±o</span>
          <span class="detail-value">{{ song().year }}</span>
        </div>
      </div>

      <div class="detail-item">
        <div class="detail-icon">ğŸ”¢</div>
        <div class="detail-content">
          <span class="detail-label">NÃºmero de Pista</span>
          <span class="detail-value">{{ song().trackNumber }}</span>
        </div>
      </div>

      <div class="detail-item">
        <div class="detail-icon">â±ï¸</div>
        <div class="detail-content">
          <span class="detail-label">DuraciÃ³n</span>
          <span class="detail-value">{{ formatDuration(song().duration) }}</span>
        </div>
      </div>

      <div class="detail-item">
        <div class="detail-icon">ğŸ”Š</div>
        <div class="detail-content">
          <span class="detail-label">Contenido</span>
          <span class="detail-value">{{ song().isExplicit ? 'ExplÃ­cito' : 'Apto para todo pÃºblico' }}</span>
        </div>
      </div>

    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button class="edit-btn" (click)="enableEditMode()">
        âœï¸ Modificar
      </button>
      <button class="delete-btn" (click)="confirmDelete()">
        ğŸ—‘ï¸ Eliminar
      </button>
    </div>

  </div>

  <!-- FORMULARIO DE EDICIÃ“N -->
  <div class="detail-card" *ngIf="isEditing">

    <h1 class="form-title">âœï¸ Modificar CanciÃ³n</h1>

    <form (ngSubmit)="onUpdate()" #editForm="ngForm">

      <!-- TÃ­tulo -->
      <div class="form-group">
        <label for="title">ğŸµ TÃ­tulo *</label>
        <input
          type="text"
          id="title"
          name="title"
          [(ngModel)]="editSong.title"
          required>
      </div>

      <!-- Artista -->
      <div class="form-group">
        <label for="artist">ğŸ‘¤ Artista *</label>
        <input
          type="text"
          id="artist"
          name="artist"
          [(ngModel)]="editSong.artist"
          required>
      </div>

      <!-- GÃ©nero -->
      <div class="form-group">
        <label for="genre">ğŸ¸ GÃ©nero *</label>
        <input
          type="text"
          id="genre"
          name="genre"
          [(ngModel)]="editSong.genre"
          required>
      </div>

      <!-- Ãlbum -->
      <div class="form-group">
        <label for="album">ğŸ’¿ Ãlbum *</label>
        <input
          type="text"
          id="album"
          name="album"
          [(ngModel)]="editSong.album"
          required>
      </div>

      <!-- DuraciÃ³n -->
      <div class="form-group">
        <label for="duration">â±ï¸ DuraciÃ³n (segundos) *</label>
        <input
          type="number"
          id="duration"
          name="duration"
          [(ngModel)]="editSong.duration"
          required
          min="1">
      </div>

      <!-- AÃ±o -->
      <div class="form-group">
        <label for="year">ğŸ“… AÃ±o *</label>
        <input
          type="number"
          id="year"
          name="year"
          [(ngModel)]="editSong.year"
          required
          min="1900"
          max="2030">
      </div>

      <!-- NÃºmero de Pista -->
      <div class="form-group">
        <label for="trackNumber">ğŸ”¢ NÃºmero de Pista *</label>
        <input
          type="number"
          id="trackNumber"
          name="trackNumber"
          [(ngModel)]="editSong.trackNumber"
          required
          min="1">
      </div>

      <!-- Contenido ExplÃ­cito -->
      <div class="form-group checkbox-group">
        <label>
          <input
            type="checkbox"
            name="isExplicit"
            [(ngModel)]="editSong.isExplicit">
          ğŸ…´ Contenido ExplÃ­cito
        </label>
      </div>

      <!-- Botones -->
      <div class="form-buttons">
        <button
          type="submit"
          class="btn-submit"
          [disabled]="!editForm.form.valid || isSubmitting">
          {{ isSubmitting ? 'â³ Guardando...' : 'âœ… Guardar Cambios' }}
        </button>

        <button
          type="button"
          class="btn-cancel"
          (click)="cancelEdit()">
          âŒ Cancelar
        </button>
      </div>

      <!-- Mensaje de Ã©xito -->
      <div class="success-message" *ngIf="showSuccess">
        âœ… Â¡CanciÃ³n actualizada exitosamente!
      </div>

      <!-- Mensaje de error -->
      <div class="error-message" *ngIf="errorMessage">
        âŒ Error: {{ errorMessage }}
      </div>

    </form>

  </div>
</div>

<!-- Modal de confirmaciÃ³n para eliminar -->
<div class="modal-overlay" *ngIf="showDeleteModal" (click)="showDeleteModal = false">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <h2>âš ï¸ Confirmar EliminaciÃ³n</h2>
    <p>Â¿EstÃ¡s seguro de que deseas eliminar esta canciÃ³n?</p>
    <p class="song-name">"{{ song().title }}" - {{ song().artist }}</p>
    <p class="warning-text">Esta acciÃ³n no se puede deshacer.</p>

    <div class="modal-buttons">
      <button class="btn-confirm-delete" (click)="deleteSong()">
        ğŸ—‘ï¸ SÃ­, Eliminar
      </button>
      <button class="btn-cancel-modal" (click)="showDeleteModal = false">
        âŒ Cancelar
      </button>
    </div>
  </div>
</div>
